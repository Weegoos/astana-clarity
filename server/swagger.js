import swaggerJSDoc from "swagger-jsdoc";
import swaggerUi from "swagger-ui-express";

const options = {
    definition: {
        openapi: "3.0.0",
        info: {
            title: "API –ó–∞–º–µ—Ç–æ–∫",
            version: "1.0.0",
            description: "–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API –¥–ª—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∑–∞–º–µ—Ç–æ–∫"
        },
        components: {
            securitySchemes: {
                bearerAuth: {
                    type: "http",
                    scheme: "bearer",
                    bearerFormat: "JWT"
                }
            }
        },
        security: [{ bearerAuth: [] }] // –ì–ª–æ–±–∞–ª—å–Ω–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
    },
    apis: [
        "./routers/**/*.js",       // –ü—É—Ç–∏ –¥–æ –≤—Å–µ—Ö —Ä–æ—É—Ç–µ—Ä–æ–≤
        "./models/**/*.js",        // –ü—É—Ç–∏ –¥–æ –≤—Å–µ—Ö –º–æ–¥–µ–ª–µ–π
        "./swagger/**/*.js"        // –ü—É—Ç—å –¥–æ –ø–∞–ø–∫–∏ —Å Swagger-–∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏
    ]
};

const swaggerSpec = swaggerJSDoc(options);

const setupSwagger = (app) => {
    app.use("/api-docs", swaggerUi.serve, swaggerUi.setup(swaggerSpec));
    console.log(`üìÑ Swagger –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∞–¥—Ä–µ—Å—É: http://localhost:${process.env.PORT || 8000}/api-docs`);
};

export default setupSwagger;